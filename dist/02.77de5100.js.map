{"version":3,"sources":["index.ts"],"names":[],"mappings":"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","file":"02.77de5100.js","sourceRoot":"../src/02","sourcesContent":["const $ = selectors => document.querySelector(selectors);\nconst $$ = selectors => document.querySelectorAll(selectors);\nconst navList = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"];\n\nconst holdItemDom = document.createElement(\"div\");\nholdItemDom.classList.add(\"item\", \"hold\");\nconst listDom = document.createElement(\"div\");\nlistDom.classList.add(\"items\");\nnavList.forEach((v, i) => {\n  const itemDom = document.createElement(\"div\");\n  itemDom.classList.add(\"item\");\n  itemDom.dataset.sortindex = i as any;\n  itemDom.textContent = v;\n  listDom.appendChild(itemDom);\n});\n\n$(\".box\").appendChild(listDom);\n\n//主要代码\nvar dragObj;\n//考虑到item数量会很多，不需要给每个item单独绑定mousedown,mousemove,mouseup事件\nlistDom.onmousedown = event => {\n  let currenIndex, previousIndex;\n  const itemDomList = $$(\".items .item\");\n  const listLength = navList.length;\n  const startY = event.clientY;\n  //找到mousedown的item\n  let selectIndex;\n  dragObj = event.target;\n  Array.from(itemDomList).forEach((v, i) => {\n    if (v === event.target) {\n      selectIndex = i;\n    }\n  });\n\n  dragObj.after(holdItemDom);\n  dragObj.classList.add(\"select\");\n  dragObj.style.top = dragObj.clientHeight * selectIndex + \"px\";\n\n  const itemHeight = dragObj.clientHeight;\n  let topIndex = selectIndex;\n  const startTop = dragObj.style.top;\n\n  previousIndex = Math.ceil((parseInt(startTop) - itemHeight / 2) / itemHeight);\n  document.onmousemove = function(event) {\n    dragObj.classList.add(\"select\");\n    const moveY = event.clientY;\n    const presentTop = parseInt(startTop) + (moveY - startY);\n    dragObj.style.top = presentTop + \"px\";\n    currenIndex = Math.ceil((presentTop - itemHeight / 2) / itemHeight);\n    if (currenIndex < 0) currenIndex = 0;\n    if (currenIndex > listLength - 1) currenIndex = listLength - 1;\n    if (previousIndex !== currenIndex) {\n      holdItemDom.remove();\n      if (previousIndex > currenIndex && currenIndex < topIndex) {\n        dragObj.remove();\n        itemDomList[currenIndex].before(dragObj);\n        dragObj.after(holdItemDom);\n      } else {\n        const currentItems = $$(\".box .item\");\n        currentItems[currenIndex].after(holdItemDom);\n      }\n      previousIndex = currenIndex;\n      if (currenIndex < topIndex) topIndex = currenIndex;\n    }\n  };\n  document.onmouseup = function(event) {\n    const currentItems = $$(\".box .item\");\n    if (currenIndex > topIndex) {\n      currentItems[currenIndex].after(dragObj);\n    }\n    holdItemDom.remove();\n    dragObj.classList.remove(\"select\");\n    dragObj.removeAttribute(\"style\");\n    document.onmousemove = null;\n    document.onmouseup = null;\n  };\n};\n"]}